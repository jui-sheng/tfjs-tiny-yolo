{"id":"3aT2","dependencies":[{"name":"D:\\tfjs\\tfjs-yolo-tiny-demo\\.babelrc","includedInParent":true,"mtime":1552031968500},{"name":"D:\\tfjs\\tfjs-yolo-tiny-demo\\package.json","includedInParent":true,"mtime":1552034066887},{"name":"@tensorflow/tfjs","loc":{"line":29,"column":20},"parent":"D:\\tfjs\\tfjs-yolo-tiny-demo\\src\\webcam.js","resolved":"D:\\tfjs\\tfjs-yolo-tiny-demo\\node_modules\\@tensorflow\\tfjs\\dist\\tf.esm.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.Webcam=void 0;var e=t(require(\"@tensorflow/tfjs\"));function t(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,i):{};r.get||r.set?Object.defineProperty(t,i,r):t[i]=e[i]}return t.default=e,t}class i{constructor(e){this.webcamElement=e}capture(){return e.tidy(()=>{const t=e.fromPixels(this.webcamElement);return this.cropImage(t).expandDims(0).toFloat().div(e.scalar(255))})}cropImage(e){const t=Math.min(e.shape[0],e.shape[1]),i=e.shape[0]/2-t/2,r=e.shape[1]/2-t/2;return e.slice([i,r,0],[t,t,3])}adjustVideoSize(e,t){const i=e/t;e>=t?this.webcamElement.width=i*this.webcamElement.height:e<t&&(this.webcamElement.height=this.webcamElement.width/i)}async setup(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){const e=await navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:\"environment\"}});return window.stream=e,this.webcamElement.srcObject=e,new Promise(e=>{this.webcamElement.onloadedmetadata=(()=>{this.adjustVideoSize(this.webcamElement.videoWidth,this.webcamElement.videoHeight),e()})})}throw new Error(\"No webcam found!\")}}exports.Webcam=i;"},"sourceMaps":{"js":{"mappings":[{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":0}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":13}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":20}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":35}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":43}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":56}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":57}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":64}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":68}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":76}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":88}},{"source":"webcam.js","original":{"line":29,"column":0},"generated":{"line":1,"column":90}},{"source":"webcam.js","original":{"line":29,"column":0},"generated":{"line":1,"column":94}},{"source":"webcam.js","original":{"line":29,"column":0},"generated":{"line":1,"column":96}},{"source":"webcam.js","original":{"line":29,"column":0},"generated":{"line":1,"column":98}},{"source":"webcam.js","original":{"line":29,"column":0},"generated":{"line":1,"column":106}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":127}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":136}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":138}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":141}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":144}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":147}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":149}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":160}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":167}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":169}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":173}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":175}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":178}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":181}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":187}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":189}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":193}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":197}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":202}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":204}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":207}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":214}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":224}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":239}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":244}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":246}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":249}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":250}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":254}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":256}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":263}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":279}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":286}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":311}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":318}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":343}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":345}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":348}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":351}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":353}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":358}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":360}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":364}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":371}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":386}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":388}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":390}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":393}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":395}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":398}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":400}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":403}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":410}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":412}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":420}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":422}},{"source":"webcam.js","original":{"line":34,"column":7},"generated":{"line":1,"column":424}},{"source":"webcam.js","name":"Webcam","original":{"line":34,"column":13},"generated":{"line":1,"column":430}},{"source":"webcam.js","name":"constructor","original":{"line":38,"column":2},"generated":{"line":1,"column":432}},{"source":"webcam.js","name":"webcamElement","original":{"line":38,"column":14},"generated":{"line":1,"column":444}},{"source":"webcam.js","name":"webcamElement","original":{"line":39,"column":9},"generated":{"line":1,"column":447}},{"source":"webcam.js","name":"webcamElement","original":{"line":39,"column":9},"generated":{"line":1,"column":452}},{"source":"webcam.js","name":"webcamElement","original":{"line":39,"column":25},"generated":{"line":1,"column":466}},{"source":"webcam.js","name":"capture","original":{"line":46,"column":2},"generated":{"line":1,"column":468}},{"source":"webcam.js","name":"tf","original":{"line":47,"column":11},"generated":{"line":1,"column":478}},{"source":"webcam.js","name":"tf","original":{"line":47,"column":11},"generated":{"line":1,"column":485}},{"source":"webcam.js","name":"tidy","original":{"line":47,"column":14},"generated":{"line":1,"column":487}},{"source":"webcam.js","original":{"line":47,"column":19},"generated":{"line":1,"column":492}},{"source":"webcam.js","name":"webcamImage","original":{"line":49,"column":12},"generated":{"line":1,"column":497}},{"source":"webcam.js","name":"webcamImage","original":{"line":49,"column":12},"generated":{"line":1,"column":503}},{"source":"webcam.js","name":"tf","original":{"line":49,"column":26},"generated":{"line":1,"column":505}},{"source":"webcam.js","name":"fromPixels","original":{"line":49,"column":29},"generated":{"line":1,"column":507}},{"source":"webcam.js","original":{"line":49,"column":40},"generated":{"line":1,"column":518}},{"source":"webcam.js","name":"webcamElement","original":{"line":49,"column":45},"generated":{"line":1,"column":523}},{"source":"webcam.js","name":"batchedImage","original":{"line":60,"column":13},"generated":{"line":1,"column":538}},{"source":"webcam.js","original":{"line":53,"column":27},"generated":{"line":1,"column":545}},{"source":"webcam.js","name":"cropImage","original":{"line":53,"column":32},"generated":{"line":1,"column":550}},{"source":"webcam.js","name":"webcamImage","original":{"line":53,"column":42},"generated":{"line":1,"column":560}},{"source":"webcam.js","name":"expandDims","original":{"line":56,"column":40},"generated":{"line":1,"column":563}},{"source":"webcam.js","original":{"line":56,"column":51},"generated":{"line":1,"column":574}},{"source":"webcam.js","name":"toFloat","original":{"line":60,"column":26},"generated":{"line":1,"column":577}},{"source":"webcam.js","name":"div","original":{"line":60,"column":36},"generated":{"line":1,"column":587}},{"source":"webcam.js","name":"tf","original":{"line":60,"column":40},"generated":{"line":1,"column":591}},{"source":"webcam.js","name":"scalar","original":{"line":60,"column":43},"generated":{"line":1,"column":593}},{"source":"webcam.js","original":{"line":60,"column":50},"generated":{"line":1,"column":600}},{"source":"webcam.js","name":"cropImage","original":{"line":68,"column":2},"generated":{"line":1,"column":608}},{"source":"webcam.js","name":"img","original":{"line":68,"column":12},"generated":{"line":1,"column":618}},{"source":"webcam.js","name":"size","original":{"line":69,"column":10},"generated":{"line":1,"column":621}},{"source":"webcam.js","name":"size","original":{"line":69,"column":10},"generated":{"line":1,"column":627}},{"source":"webcam.js","name":"Math","original":{"line":69,"column":17},"generated":{"line":1,"column":629}},{"source":"webcam.js","name":"min","original":{"line":69,"column":22},"generated":{"line":1,"column":634}},{"source":"webcam.js","name":"img","original":{"line":69,"column":26},"generated":{"line":1,"column":638}},{"source":"webcam.js","name":"shape","original":{"line":69,"column":30},"generated":{"line":1,"column":640}},{"source":"webcam.js","original":{"line":69,"column":36},"generated":{"line":1,"column":646}},{"source":"webcam.js","name":"img","original":{"line":69,"column":40},"generated":{"line":1,"column":649}},{"source":"webcam.js","name":"shape","original":{"line":69,"column":44},"generated":{"line":1,"column":651}},{"source":"webcam.js","original":{"line":69,"column":50},"generated":{"line":1,"column":657}},{"source":"webcam.js","name":"beginHeight","original":{"line":71,"column":10},"generated":{"line":1,"column":661}},{"source":"webcam.js","name":"img","original":{"line":70,"column":25},"generated":{"line":1,"column":663}},{"source":"webcam.js","name":"shape","original":{"line":70,"column":29},"generated":{"line":1,"column":665}},{"source":"webcam.js","original":{"line":70,"column":35},"generated":{"line":1,"column":671}},{"source":"webcam.js","original":{"line":70,"column":40},"generated":{"line":1,"column":674}},{"source":"webcam.js","name":"size","original":{"line":71,"column":40},"generated":{"line":1,"column":676}},{"source":"webcam.js","original":{"line":71,"column":47},"generated":{"line":1,"column":678}},{"source":"webcam.js","name":"beginWidth","original":{"line":73,"column":10},"generated":{"line":1,"column":680}},{"source":"webcam.js","name":"img","original":{"line":72,"column":24},"generated":{"line":1,"column":682}},{"source":"webcam.js","name":"shape","original":{"line":72,"column":28},"generated":{"line":1,"column":684}},{"source":"webcam.js","original":{"line":72,"column":34},"generated":{"line":1,"column":690}},{"source":"webcam.js","original":{"line":72,"column":39},"generated":{"line":1,"column":693}},{"source":"webcam.js","name":"size","original":{"line":73,"column":38},"generated":{"line":1,"column":695}},{"source":"webcam.js","original":{"line":73,"column":45},"generated":{"line":1,"column":697}},{"source":"webcam.js","name":"img","original":{"line":74,"column":11},"generated":{"line":1,"column":699}},{"source":"webcam.js","name":"img","original":{"line":74,"column":11},"generated":{"line":1,"column":706}},{"source":"webcam.js","name":"slice","original":{"line":74,"column":15},"generated":{"line":1,"column":708}},{"source":"webcam.js","original":{"line":74,"column":21},"generated":{"line":1,"column":714}},{"source":"webcam.js","name":"beginHeight","original":{"line":74,"column":22},"generated":{"line":1,"column":715}},{"source":"webcam.js","name":"beginWidth","original":{"line":74,"column":35},"generated":{"line":1,"column":717}},{"source":"webcam.js","original":{"line":74,"column":47},"generated":{"line":1,"column":719}},{"source":"webcam.js","original":{"line":74,"column":51},"generated":{"line":1,"column":722}},{"source":"webcam.js","name":"size","original":{"line":74,"column":52},"generated":{"line":1,"column":723}},{"source":"webcam.js","name":"size","original":{"line":74,"column":58},"generated":{"line":1,"column":725}},{"source":"webcam.js","original":{"line":74,"column":64},"generated":{"line":1,"column":727}},{"source":"webcam.js","name":"adjustVideoSize","original":{"line":83,"column":2},"generated":{"line":1,"column":731}},{"source":"webcam.js","name":"width","original":{"line":83,"column":18},"generated":{"line":1,"column":747}},{"source":"webcam.js","name":"height","original":{"line":83,"column":25},"generated":{"line":1,"column":749}},{"source":"webcam.js","name":"aspectRatio","original":{"line":84,"column":10},"generated":{"line":1,"column":752}},{"source":"webcam.js","name":"aspectRatio","original":{"line":84,"column":10},"generated":{"line":1,"column":758}},{"source":"webcam.js","name":"width","original":{"line":84,"column":24},"generated":{"line":1,"column":760}},{"source":"webcam.js","name":"height","original":{"line":84,"column":32},"generated":{"line":1,"column":762}},{"source":"webcam.js","name":"width","original":{"line":85,"column":8},"generated":{"line":1,"column":764}},{"source":"webcam.js","name":"height","original":{"line":85,"column":17},"generated":{"line":1,"column":767}},{"source":"webcam.js","name":"webcamElement","original":{"line":86,"column":11},"generated":{"line":1,"column":769}},{"source":"webcam.js","name":"webcamElement","original":{"line":86,"column":11},"generated":{"line":1,"column":774}},{"source":"webcam.js","name":"width","original":{"line":86,"column":25},"generated":{"line":1,"column":788}},{"source":"webcam.js","name":"aspectRatio","original":{"line":86,"column":33},"generated":{"line":1,"column":794}},{"source":"webcam.js","original":{"line":86,"column":47},"generated":{"line":1,"column":796}},{"source":"webcam.js","name":"webcamElement","original":{"line":86,"column":52},"generated":{"line":1,"column":801}},{"source":"webcam.js","name":"height","original":{"line":86,"column":66},"generated":{"line":1,"column":815}},{"source":"webcam.js","name":"width","original":{"line":87,"column":15},"generated":{"line":1,"column":822}},{"source":"webcam.js","name":"height","original":{"line":87,"column":23},"generated":{"line":1,"column":824}},{"source":"webcam.js","name":"webcamElement","original":{"line":88,"column":11},"generated":{"line":1,"column":828}},{"source":"webcam.js","name":"webcamElement","original":{"line":88,"column":11},"generated":{"line":1,"column":833}},{"source":"webcam.js","name":"height","original":{"line":88,"column":25},"generated":{"line":1,"column":847}},{"source":"webcam.js","original":{"line":88,"column":34},"generated":{"line":1,"column":854}},{"source":"webcam.js","name":"webcamElement","original":{"line":88,"column":39},"generated":{"line":1,"column":859}},{"source":"webcam.js","name":"width","original":{"line":88,"column":53},"generated":{"line":1,"column":873}},{"source":"webcam.js","name":"aspectRatio","original":{"line":88,"column":61},"generated":{"line":1,"column":879}},{"source":"webcam.js","name":"setup","original":{"line":92,"column":8},"generated":{"line":1,"column":882}},{"source":"webcam.js","name":"navigator","original":{"line":93,"column":8},"generated":{"line":1,"column":896}},{"source":"webcam.js","name":"navigator","original":{"line":93,"column":8},"generated":{"line":1,"column":899}},{"source":"webcam.js","name":"mediaDevices","original":{"line":93,"column":18},"generated":{"line":1,"column":909}},{"source":"webcam.js","name":"navigator","original":{"line":93,"column":34},"generated":{"line":1,"column":923}},{"source":"webcam.js","name":"mediaDevices","original":{"line":93,"column":44},"generated":{"line":1,"column":933}},{"source":"webcam.js","name":"getUserMedia","original":{"line":93,"column":57},"generated":{"line":1,"column":946}},{"source":"webcam.js","original":{"line":93,"column":71},"generated":{"line":1,"column":959}},{"source":"webcam.js","name":"stream","original":{"line":94,"column":12},"generated":{"line":1,"column":960}},{"source":"webcam.js","name":"stream","original":{"line":94,"column":12},"generated":{"line":1,"column":966}},{"source":"webcam.js","name":"navigator","original":{"line":94,"column":27},"generated":{"line":1,"column":974}},{"source":"webcam.js","name":"mediaDevices","original":{"line":94,"column":37},"generated":{"line":1,"column":984}},{"source":"webcam.js","name":"getUserMedia","original":{"line":94,"column":50},"generated":{"line":1,"column":997}},{"source":"webcam.js","original":{"line":94,"column":63},"generated":{"line":1,"column":1010}},{"source":"webcam.js","original":{"line":95,"column":17},"generated":{"line":1,"column":1011}},{"source":"webcam.js","original":{"line":95,"column":17},"generated":{"line":1,"column":1018}},{"source":"webcam.js","original":{"line":96,"column":17},"generated":{"line":1,"column":1020}},{"source":"webcam.js","original":{"line":96,"column":17},"generated":{"line":1,"column":1026}},{"source":"webcam.js","name":"facingMode","original":{"line":96,"column":18},"generated":{"line":1,"column":1027}},{"source":"webcam.js","original":{"line":96,"column":30},"generated":{"line":1,"column":1038}},{"source":"webcam.js","original":{"line":100,"column":13},"generated":{"line":1,"column":1055}},{"source":"webcam.js","name":"window","original":{"line":98,"column":6},"generated":{"line":1,"column":1062}},{"source":"webcam.js","name":"stream","original":{"line":98,"column":13},"generated":{"line":1,"column":1069}},{"source":"webcam.js","name":"stream","original":{"line":98,"column":22},"generated":{"line":1,"column":1076}},{"source":"webcam.js","name":"webcamElement","original":{"line":99,"column":11},"generated":{"line":1,"column":1078}},{"source":"webcam.js","name":"webcamElement","original":{"line":99,"column":11},"generated":{"line":1,"column":1083}},{"source":"webcam.js","name":"srcObject","original":{"line":99,"column":25},"generated":{"line":1,"column":1097}},{"source":"webcam.js","name":"stream","original":{"line":99,"column":37},"generated":{"line":1,"column":1107}},{"source":"webcam.js","original":{"line":100,"column":13},"generated":{"line":1,"column":1109}},{"source":"webcam.js","name":"Promise","original":{"line":100,"column":17},"generated":{"line":1,"column":1113}},{"source":"webcam.js","name":"resolve","original":{"line":100,"column":25},"generated":{"line":1,"column":1121}},{"source":"webcam.js","name":"webcamElement","original":{"line":101,"column":13},"generated":{"line":1,"column":1125}},{"source":"webcam.js","name":"webcamElement","original":{"line":101,"column":13},"generated":{"line":1,"column":1130}},{"source":"webcam.js","name":"onloadedmetadata","original":{"line":101,"column":27},"generated":{"line":1,"column":1144}},{"source":"webcam.js","original":{"line":101,"column":46},"generated":{"line":1,"column":1161}},{"source":"webcam.js","name":"adjustVideoSize","original":{"line":102,"column":15},"generated":{"line":1,"column":1167}},{"source":"webcam.js","name":"adjustVideoSize","original":{"line":102,"column":15},"generated":{"line":1,"column":1172}},{"source":"webcam.js","original":{"line":103,"column":12},"generated":{"line":1,"column":1188}},{"source":"webcam.js","name":"webcamElement","original":{"line":103,"column":17},"generated":{"line":1,"column":1193}},{"source":"webcam.js","name":"videoWidth","original":{"line":103,"column":31},"generated":{"line":1,"column":1207}},{"source":"webcam.js","original":{"line":104,"column":12},"generated":{"line":1,"column":1218}},{"source":"webcam.js","name":"webcamElement","original":{"line":104,"column":17},"generated":{"line":1,"column":1223}},{"source":"webcam.js","name":"videoHeight","original":{"line":104,"column":31},"generated":{"line":1,"column":1237}},{"source":"webcam.js","name":"resolve","original":{"line":105,"column":10},"generated":{"line":1,"column":1250}},{"source":"webcam.js","original":{"line":109,"column":12},"generated":{"line":1,"column":1258}},{"source":"webcam.js","original":{"line":109,"column":12},"generated":{"line":1,"column":1264}},{"source":"webcam.js","name":"Error","original":{"line":109,"column":16},"generated":{"line":1,"column":1268}},{"source":"webcam.js","original":{"line":109,"column":22},"generated":{"line":1,"column":1274}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":1295}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":1303}},{"source":"webcam.js","original":{"line":34,"column":20},"generated":{"line":1,"column":1310}}],"sources":{"webcam.js":"/**\r\n * @license\r\n * Copyright 2018 Google LLC. All Rights Reserved.\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n * =============================================================================\r\n */\r\n\r\n/**\r\n * This file is originally from:\r\n * https://github.com/tensorflow/tfjs-examples/blob/master/webcam-transfer-learning/webcam.js\r\n * The following modifications were made to the original file:\r\n * - `setup` has been changed to work for Safari, changes sourced from:\r\n *    https://github.com/google/emoji-scavenger-hunt/blob/master/src/js/camera.ts#L43-L56\r\n * - `capture` has been changed to just divide by 255 instead of\r\n *    divide by 127 and subtract 1.\r\n * Just run `diff` tbh, yuno MIT license.\r\n */\r\n\r\nimport * as tf from '@tensorflow/tfjs';\r\n\r\n/**\r\n * A class that wraps webcam video elements to capture Tensor4Ds.\r\n */\r\nexport class Webcam {\r\n  /**\r\n   * @param {HTMLVideoElement} webcamElement A HTMLVideoElement representing the webcam feed.\r\n   */\r\n  constructor(webcamElement) {\r\n    this.webcamElement = webcamElement;\r\n  }\r\n\r\n  /**\r\n   * Captures a frame from the webcam and normalizes it between -1 and 1.\r\n   * Returns a batched image (1-element batch) of shape [1, w, h, c].\r\n   */\r\n  capture() {\r\n    return tf.tidy(() => {\r\n      // Reads the image as a Tensor from the webcam <video> element.\r\n      const webcamImage = tf.fromPixels(this.webcamElement);\r\n\r\n      // Crop the image so we're using the center square of the rectangular\r\n      // webcam.\r\n      const croppedImage = this.cropImage(webcamImage);\r\n\r\n      // Expand the outer most dimension so we have a batch size of 1.\r\n      const batchedImage = croppedImage.expandDims(0);\r\n\r\n      // Normalize the image between -1 and 1. The image comes in between 0-255,\r\n      // so we divide by 127 and subtract 1\r\n      return batchedImage.toFloat().div(tf.scalar(255));\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Crops an image tensor so we get a square image with no white space.\r\n   * @param {Tensor4D} img An input image Tensor to crop.\r\n   */\r\n  cropImage(img) {\r\n    const size = Math.min(img.shape[0], img.shape[1]);\r\n    const centerHeight = img.shape[0] / 2;\r\n    const beginHeight = centerHeight - (size / 2);\r\n    const centerWidth = img.shape[1] / 2;\r\n    const beginWidth = centerWidth - (size / 2);\r\n    return img.slice([beginHeight, beginWidth, 0], [size, size, 3]);\r\n  }\r\n\r\n  /**\r\n   * Adjusts the video size so we can make a centered square crop without\r\n   * including whitespace.\r\n   * @param {number} width The real width of the video element.\r\n   * @param {number} height The real height of the video element.\r\n   */\r\n  adjustVideoSize(width, height) {\r\n    const aspectRatio = width / height;\r\n    if (width >= height) {\r\n      this.webcamElement.width = aspectRatio * this.webcamElement.height;\r\n    } else if (width < height) {\r\n      this.webcamElement.height = this.webcamElement.width / aspectRatio;\r\n    }\r\n  }\r\n\r\n  async setup() {\r\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\r\n      const stream = await navigator.mediaDevices.getUserMedia({\r\n        'audio': false,\r\n        'video': {facingMode: 'environment'}\r\n      });\r\n      window.stream = stream;\r\n      this.webcamElement.srcObject = stream;\r\n      return new Promise(resolve => {\r\n        this.webcamElement.onloadedmetadata = () => {\r\n          this.adjustVideoSize(\r\n            this.webcamElement.videoWidth,\r\n            this.webcamElement.videoHeight);\r\n          resolve();\r\n        };\r\n      });\r\n    } else {\r\n      throw new Error('No webcam found!');\r\n    }\r\n  }\r\n}\r\n"},"lineCount":null}},"error":null,"hash":"ee7b18912ace72dbb4be5c40b87a6184","cacheData":{"env":{}}}